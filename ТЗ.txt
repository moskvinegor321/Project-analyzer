# ULTRA‚ÄëFINAL (AI‚Äëfirst ‚Ä¢ No‚ÄëHardcode ‚Ä¢ No‚ÄëHidden‚ÄëFallbacks)

## One‚ÄëShot PROMPT –¥–ª—è Cursor: Next.js + Claude Vision + DOCX/PDF + Notion + Telegram + Vercel Blob/KV

> –°–∫–æ–ø–∏—Ä—É–π **–≤–µ—Å—å –¥–æ–∫—É–º–µ–Ω—Ç** –≤ Cursor. –†–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–±—Ä–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π:
>
> * –ü—Ä–∏–Ω–∏–º–∞–µ—Ç **DOCX/PDF**, —Å—Å—ã–ª–∫–∏ (–¢–ó, –∫–≤–æ—Ç–∞, Pipedrive, –ø—Ä–∏–º–µ—Ä—ã).
> * –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç, –¥–∞—ë—Ç **–º–æ–¥–µ–ª–∏** –≤—ã–±—Ä–∞—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã‚Äë–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —á–∞–Ω–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –ø—Ä–æ–≤–æ–¥–∏—Ç –∞–Ω–∞–ª–∏–∑ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **—Å—Ç—Ä–æ–≥–∏–π JSON**.
> * –°–æ–∑–¥–∞—ë—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ **Notion**, –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ–π—Å—Ç–≤–∞, –¥–æ–±–∞–≤–ª—è–µ—Ç –±–ª–æ–∫–∏, **PromptContextLog**.
> * –ü—É–±–ª–∏–∫—É–µ—Ç –ø–æ—Å—Ç –≤ **Telegram‚Äë–∫–∞–Ω–∞–ª** —Å –∫–Ω–æ–ø–∫–∞–º–∏ **Approve / Reject / Add information**.
> * –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç **Decision** –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ –ø–æ–ª—è –≤ Notion –ø—Ä–∏ –¥–µ–π—Å—Ç–≤–∏—è—Ö —Ä–µ–≤—å—é–µ—Ä–æ–≤.
> * –†–∞–±–æ—Ç–∞–µ—Ç —Å **Vercel Blob** (—Ñ–∞–π–ª—ã/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) –∏ **Vercel KV** (–∫—ç—à/–∑–∞—è–≤–∫–∏), –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **SSE** –∏ —Å—Ç—Ä–æ–≥—É—é –ø–æ–ª–∏—Ç–∏–∫—É –æ—à–∏–±–æ–∫.
>
> –ö—Ä–∏—Ç–∏—á–Ω–æ: **–Ω–∏–∫–∞–∫–æ–≥–æ —Ö–∞—Ä–¥–∫–æ–¥–∞**, **–Ω–∏–∫–∞–∫–∏—Ö —Å–∫—Ä—ã—Ç—ã—Ö —Ñ–æ–ª–±–µ–∫–æ–≤**. –í—Å–µ ID/–ø–æ—Ä–æ–≥–∏/–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è ‚Äî —á–µ—Ä–µ–∑ **.env** –∏ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π `config.ts`. –ï—Å–ª–∏ —à–∞–≥ –ø–∞–¥–∞–µ—Ç ‚Äî **–ø—Ä–æ—Ü–µ—Å—Å –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è** —Å —è–≤–Ω—ã–º –∫–æ–¥–æ–º –æ—à–∏–±–∫–∏.

---

## 0. –ü—Ä–∏–Ω—Ü–∏–ø—ã –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

* **AI‚Äëfirst.** –í—ã–±–æ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–æ–≤/–±–ª–æ–∫–æ–≤ ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç **–º–æ–¥–µ–ª—å**. –≠–≤—Ä–∏—Å—Ç–∏–∫–∏ ‚Äî —Ç–æ–ª—å–∫–æ –∫–∞–∫ —è–≤–Ω—ã–π **fallback** –ø–æ —Ñ–ª–∞–≥—É.
* **No hardcode.** –ù–∏–∫–∞–∫–∏—Ö –∑–∞—à–∏—Ç—ã—Ö ID Notion/–∫–∞–Ω–∞–ª–æ–≤/–ø–æ—Ä–æ–≥–æ–≤/–∏–º–µ–Ω —Å–≤–æ–π—Å—Ç–≤. –í—Å—ë ‚Äî –≤ `.env` –∏ `app/lib/config.ts`.
* **No hidden fallbacks.** –õ—é–±–∞—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ **–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–∞–π–ø–ª–∞–π–Ω**. –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (Notion/Telegram) **–Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è**, –ø–æ–∫–∞ –æ—à–∏–±–∫–∞ –Ω–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞. –í–∫–ª—é—á–∏—Ç—å —Ñ–æ–ª–±–µ–∫–∏ –º–æ–∂–Ω–æ **—Ç–æ–ª—å–∫–æ —Ñ–ª–∞–≥–æ–º** –æ–∫—Ä—É–∂–µ–Ω–∏—è.
* **Idempotent & auditable.** –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–º–µ—á–µ–Ω—ã `requestId`. –°–æ—Å—Ç–æ—è–Ω–∏–µ, –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –∏ –æ—Ü–µ–Ω–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤/—Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ **PromptContextLog** (KV + –±–ª–æ–∫ –≤ Notion).
* **Budget guard.** –ü–µ—Ä–µ–¥ –æ—Å–Ω–æ–≤–Ω—ã–º –≤—ã–∑–æ–≤–æ–º –º–æ–¥–µ–ª–∏ –æ—Ü–µ–Ω–∏–≤–∞–µ–º —Ç–æ–∫–µ–Ω—ã/—Å—Ç–æ–∏–º–æ—Å—Ç—å. –ü—Ä–∏ —Ä–∏—Å–∫–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è ‚Äî –º–æ–¥–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–¥–∞—á—É **—Å–∂–∞—Ç—å –≤—Ö–æ–¥** –∏/–∏–ª–∏ **—Å–æ–∫—Ä–∞—Ç–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ª–∏–º–∏—Ç–æ–≤.
* **Strict errors.** –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `STRICT_ERRORS=true`: –Ω–∏–∫–∞–∫–æ–π –∞–≤—Ç–æ–ø–æ—á–∏–Ω–∫–∏ JSON; —Ç–æ—á–Ω—ã–π –∫–æ–¥ –æ—à–∏–±–∫–∏ –≤ UI –∏ –ª–æ–≥–∞—Ö. –†–∞–∑—Ä–µ—à–∏—Ç—å –æ–¥–Ω—É –ø–æ–ø—ã—Ç–∫—É –∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `STRICT_ERRORS=false`.

### 0.1 –ö–æ–¥—ã –æ—à–∏–±–æ–∫ (enum)

```
UPLOAD_ERROR
PDF_RENDER_ERROR
DOC_EXTRACT_ERROR
DOCS_FETCH_ERROR
MODEL_INVALID_JSON
BUDGET_EXCEEDED
NOTION_ERROR
TELEGRAM_POST_ERROR
TELEGRAM_DM_ERROR
DIAGRAM_ROI_UNSTABLE
USERNAME_NOT_REGISTERED
```

---

## 1. –°—Ç–µ–∫ –∏ –¥–µ–ø–ª–æ–π

* **Next.js 14+ (App Router)**, **TypeScript strict**
* **Tailwind CSS**, **shadcn/ui**
* **Claude 3.5 Sonnet** (Messages API, **vision**, SSE)
* **Vercel Blob** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏ —Ä–µ–Ω–¥–µ—Ä–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü
* **Vercel KV** ‚Äî –∫—ç—à –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∑–∞—è–≤–∫–∏, Telegram users, –æ–∂–∏–¥–∞–Ω–∏—è ForceReply
* **Notion API** ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤ –±–∞–∑–µ + —Å–≤–æ–π—Å—Ç–≤–∞ + –±–ª–æ–∫–∏ + –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (File Upload API ‚Äî –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è, fallback –Ω–∞ URL)
* **Telegram Bot API** ‚Äî –∫–∞–Ω–∞–ª/—Ç–æ–ø–∏–∫, –∏–Ω–ª–∞–π–Ω‚Äë–∫–Ω–æ–ø–∫–∏, ForceReply, DM –∑–∞—è–≤–∏—Ç–µ–ª—é
* –î–µ–ø–ª–æ–π: **Vercel**

---

## 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (—Å–æ–∑–¥–∞—Ç—å —Ä–æ–≤–Ω–æ —Ç–∞–∫)

```
document-analyzer/
‚îú‚îÄ‚îÄ .cursorrules
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ vercel.json
‚îú‚îÄ‚îÄ next.config.js
‚îú‚îÄ‚îÄ tailwind.config.js
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ components.json
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ documentation/route.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ analyze/route.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ notion/route.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ telegram/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ webhook/route.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ send/route.ts
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FileUpload.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DocumentationInput.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProcessingStatus.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AnalysisResult.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui/ (shadcn components)
‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ blob.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ docx.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pdf.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ diagrams.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ documentation.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ claude.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ notion.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ telegram.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cache.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ratelimit.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.ts
‚îÇ   ‚îú‚îÄ‚îÄ types/index.ts
‚îÇ   ‚îú‚îÄ‚îÄ globals.css
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
‚îî‚îÄ‚îÄ public/
```

---

## 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env.example`)

```bash
# Anthropic
ANTHROPIC_API_KEY=
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
AI_MAX_INPUT_TOKENS=180000
AI_MAX_IMAGES=10
AI_COMPRESS_LONG_DOCS=true
AI_MODEL_DRIVEN_SELECTION=true
AI_ENABLE_HEURISTICS_FALLBACK=false
STRICT_ERRORS=true
COST_SOFT_LIMIT_USD=0.50
AI_DISABLE_UPLOADS=false

# Notion
NOTION_TOKEN=
NOTION_DATABASE_ID=
# JSON-–º—ç–ø –∏–º—ë–Ω —Å–≤–æ–π—Å—Ç–≤ ‚Üí —Ä–µ–∞–ª—å–Ω—ã–º –Ω–∞–∑–≤–∞–Ω–∏—è–º –≤ –±–∞–∑–µ (–µ—Å–ª–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è)
# –ø—Ä–∏–º–µ—Ä: {"Name":"Name","Feasibility":"Feasibility","Decision":"Decision"}
NOTION_PROPERTY_MAP={}

# Telegram
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHANNEL_ID=
TELEGRAM_THREAD_ID=0
TELEGRAM_WEBHOOK_SECRET=
TELEGRAM_BOT_USERNAME=
# –°–ø–∏—Å–æ–∫ —Ä–µ–≤—å—é—Ä–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é: @user1,@user2
TELEGRAM_REVIEWERS=

# Vercel Blob
BLOB_READ_WRITE_TOKEN=

# Vercel KV 
KV_REST_API_URL=
KV_REST_API_TOKEN=
KV_REST_API_READ_ONLY_TOKEN=

# PDF Processing
PDF_MAX_PAGES=200
PDF_RENDER_WIDTH=1600
PDF_MAX_DIAGRAM_PAGES=10
ENABLE_OCR=false

# Security / Service
ALLOWED_DOC_DOMAINS=
NEXT_PUBLIC_APP_URL=
NEXTAUTH_SECRET=
# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–º –ø—Ä–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
NEEDS_INFO_ON_COMMENT=true
```

---

## 4. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–≥–æ)

```ts
export type ErrorCode =
  | 'UPLOAD_ERROR'
  | 'PDF_RENDER_ERROR'
  | 'DOC_EXTRACT_ERROR'
  | 'DOCS_FETCH_ERROR'
  | 'MODEL_INVALID_JSON'
  | 'BUDGET_EXCEEDED'
  | 'NOTION_ERROR'
  | 'TELEGRAM_POST_ERROR'
  | 'TELEGRAM_DM_ERROR'
  | 'DIAGRAM_ROI_UNSTABLE'
  | 'USERNAME_NOT_REGISTERED';

export interface DiagramFinding {
  page: number;
  type: 'diagram' | 'chart' | 'table' | 'unknown';
  description: string;
  implications: string;
  imageUrl?: string;
  bbox?: { x: number; y: number; w: number; h: number };
}

export interface AnalysisResult {
  feasibility: 'high' | 'medium' | 'low' | 'unknown';
  comments: string;
  missingRequirements: string[];
  estimatedTimeline: string;
  confidence: number; // 0..1
  documentSummary: string;
  diagramFindings?: DiagramFinding[];
  notionBlocks?: any[];
  process?: string;
  documentTypes?: string[];
  fieldsToExtract?: string[];
  volumePages?: { min?: number; max?: number; raw: string };
  arrRub?: number | null;
  acvRub?: number | null;
  placement?: 'Cloud' | 'On-prem' | 'Hybrid' | 'Unknown';
  securityTags?: string[];
  links?: { quota?: string; tz?: string; pipedrive?: string; examples?: string; blob?: string };
}

export interface PromptContextLog {
  docSummaryUsed: string;
  selectedDocChunks: Array<{ id: string; title: string; reason: string }>;
  selectedImages: Array<{ page: number; url: string; reason: string }>;
  tokenEstimate: { input: number; output?: number };
  costEstimateUsd?: number;
  autoFixed?: boolean;
}

export interface SubmissionPayload {
  projectName: string;
  telegramUsername: string; // '@nick' –∏–ª–∏ 'nick'
  documentationUrls: string[];
  tzLink?: string;
  quotaLink: string;
  pipedriveLink?: string;
  examplesLink?: string;
  blobUrl: string;
  fileName: string;
}

export interface ReviewRequest extends SubmissionPayload {
  id: string;
  createdAt: number;
  status: 'pending' | 'approved' | 'rejected' | 'needs-info' | 'completed' | 'error';
  notionPageId?: string;
  notionUrl?: string;
  analysis?: AnalysisResult;
  requester: { username: string; userId?: number };
  telegram: { channelMessageId?: number; threadId?: number };
}

export interface ApiErrorResponse {
  ok: false;
  code: ErrorCode;
  message: string;
}

export interface ProcessingStatus {
  stage: 'uploading' | 'processing-docx' | 'processing-pdf' | 'selecting-images' | 'fetching-docs' | 'selecting-chunks' | 'analyzing' | 'creating-notion' | 'posting-telegram' | 'completed' | 'error';
  progress: number; // 0-100
  message: string;
  error?: { code: ErrorCode; details: string };
}
```

---

## 5. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 5.1 .cursorrules
```markdown
# Document Analyzer AI-First Project Rules

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- Next.js 14+ App Router –¢–û–õ–¨–ö–û
- TypeScript strict mode –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
- –í—Å–µ —Ç–∏–ø—ã –≤ app/types/index.ts
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ app/lib/config.ts
- –ù–∏–∫–∞–∫–æ–≥–æ —Ö–∞—Ä–¥–∫–æ–¥–∞ - –≤—Å–µ —á–µ—Ä–µ–∑ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

## AI-First –ø–æ–¥—Ö–æ–¥
- –í—ã–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/—á–∞–Ω–∫–æ–≤ –í–°–ï–ì–î–ê —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å
- –≠–≤—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–ª—å–∫–æ –∫–∞–∫ fallback –ø–æ —Ñ–ª–∞–≥—É
- –°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è JSON –æ—Ç–≤–µ—Ç–æ–≤ –º–æ–¥–µ–ª–∏
- Budget guard –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –≤—ã–∑–æ–≤–æ–º –º–æ–¥–µ–ª–∏

## Error Handling
- Enum –∫–æ–¥—ã –æ—à–∏–±–æ–∫
- STRICT_ERRORS=true –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - –±–µ–∑ –∞–≤—Ç–æ—Ñ–∏–∫—Å–æ–≤
- –õ—é–±–∞—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å
- –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ KV –∏ Notion

## API Design
- SSE –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ requestId
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- Proper HTTP status codes

## Security
- Telegram webhook secret –ø—Ä–æ–≤–µ—Ä–∫–∞
- CORS —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–≤–æ–µ–≥–æ –¥–æ–º–µ–Ω–∞
- –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –ù–∏–∫–∞–∫–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

## Styling
- Tailwind CSS –∫–ª–∞—Å—Å—ã —Ç–æ–ª—å–∫–æ
- shadcn/ui –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- Responsive design –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
- Dark/light theme support
```

### 5.2 .gitignore
```gitignore
# Dependencies
/node_modules
/.pnp
.pnp.js

# Testing
/coverage

# Next.js
/.next/
/out/

# Production
/build

# Environment variables
.env
.env*.local

# Vercel
.vercel

# TypeScript
*.tsbuildinfo
next-env.d.ts

# IDE
.vscode/
.idea/
.cursor/

# OS
.DS_Store
Thumbs.db

# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Runtime
pids
*.pid
*.seed
*.pid.lock

# Coverage
coverage/
*.lcov

# Optional cache
.npm
.eslintcache

# Temporary
tmp/
temp/
/uploads
/temp-files
```

### 5.3 vercel.json
```json
{
  "functions": {
    "app/api/analyze/route.ts": {
      "maxDuration": 300
    },
    "app/api/documentation/route.ts": {
      "maxDuration": 60
    },
    "app/api/telegram/webhook/route.ts": {
      "maxDuration": 30
    }
  },
  "headers": [
    {
      "source": "/api/(.*)",
      "headers": [
        {
          "key": "Content-Security-Policy",
          "value": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob: https:; connect-src 'self' https:"
        }
      ]
    }
  ]
}
```

### 5.4 next.config.js
```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    serverComponentsExternalPackages: ['pdfjs-dist', 'mammoth', 'sharp']
  },
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: '*.vercel-storage.com',
      },
    ],
  },
  webpack: (config) => {
    config.resolve.alias.canvas = false;
    config.resolve.alias.encoding = false;
    return config;
  },
}

module.exports = nextConfig
```

---

## 6. Notion: —Å—Ö–µ–º–∞, –º–∞–ø–ø–∏–Ω–≥ –∏ –ª–æ–≥

### 6.1 –°–≤–æ–π—Å—Ç–≤–∞ –±–∞–∑—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –Ω–∞–±–æ—Ä)

* **Name** *(title)*
* **Requester** *(rich\_text)* ‚Äî `@username`
* **Telegram User ID** *(number)*
* **Feasibility** *(select: High/Medium/Low/Unknown)*
* **Confidence** *(number)*
* **Timeline** *(rich\_text)*
* **Process** *(rich\_text)*
* **Document types** *(multi\_select)*
* **Fields to extract** *(rich\_text)*
* **Volume, pages** *(number)*
* **ARR (RUB)** *(number)*
* **ACV (RUB)** *(number)*
* **Placement** *(select: Cloud/On-prem/Hybrid/Unknown)*
* **Security / Compliance** *(multi\_select)*
* **Quota Link** *(url)*
* **TZ Link** *(url)*
* **Pipedrive Link** *(url)*
* **Examples Link** *(url)*
* **Blob File URL** *(url)*
* **Decision** *(select: Pending/Approved/Rejected/Needs info/Error)*
* **Channel Message ID** *(number)*
* **Thread ID** *(number)*
* **Last Action** *(select: Approve/Reject/Add info/Comment)*
* **Last Action At** *(date)*
* **Last Moderator (TG)** *(rich\_text)*

### 6.2 –ö–æ–Ω—Ç–µ–Ω—Ç (children blocks)

1. **Summary**
2. **Feasibility & Risks**
3. **Timeline**
4. **Volumes / Workload**
5. **Document Types & Required Fields**
6. **Security / IB requirements**
7. **Output format / Integration**
8. **Diagram findings**
9. **Links**
10. **Telegram log**
11. **Prompt context log** ‚Äî –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —á–∞–Ω–∫–∏/—Å—Ç—Ä–∞–Ω–∏—Ü—ã, –ø—Ä–∏—á–∏–Ω—ã, —Ç–æ–∫–µ–Ω—ã/—Å—Ç–æ–∏–º–æ—Å—Ç—å, `autoFixed`.

### 6.3 –ú–∞–ø–ø–∏–Ω–≥ —á–µ—Ä–µ–∑ JSON

`NOTION_PROPERTY_MAP` ‚Äî JSON –≤–∏–¥–∞:

```json
{
  "Name": "Name",
  "Requester": "Requester",
  "Telegram User ID": "Telegram User ID",
  "Feasibility": "Feasibility",
  "Confidence": "Confidence",
  "Timeline": "Timeline",
  "Process": "Process",
  "Document types": "Document types",
  "Fields to extract": "Fields to extract",
  "Volume, pages": "Volume, pages",
  "ARR (RUB)": "ARR (RUB)",
  "ACV (RUB)": "ACV (RUB)",
  "Placement": "Placement",
  "Security / Compliance": "Security / Compliance",
  "Quota Link": "Quota Link",
  "TZ Link": "TZ Link",
  "Pipedrive Link": "Pipedrive Link",
  "Examples Link": "Examples Link",
  "Blob File URL": "Blob File URL",
  "Decision": "Decision",
  "Channel Message ID": "Channel Message ID",
  "Thread ID": "Thread ID",
  "Last Action": "Last Action",
  "Last Action At": "Last Action At",
  "Last Moderator (TG)": "Last Moderator (TG)"
}
```

---

## 7. Telegram: —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤

### 7.1 –°–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª (Markdown)

–°–æ–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ —à–∞–±–ª–æ–Ω—É –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ **15**. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥–∏ —Ä–µ–≤—å—é–µ—Ä–æ–≤ (`TELEGRAM_REVIEWERS`) –∏ –∑–∞—è–≤–∏—Ç–µ–ª—è `@username`.

### 7.2 –ö–Ω–æ–ø–∫–∏

`Approve` ¬∑ `Reject` ¬∑ `Add information`

* `callback_data = act:<requestId>:<approve|reject|add>`

### 7.3 –ú–∞–ø–ø–∏–Ω–≥ –¥–µ–π—Å—Ç–≤–∏–π ‚Üí Notion

| –î–µ–π—Å—Ç–≤–∏–µ                | Decision                                                                | Last Action | Last Action At | Last Moderator (TG) |
| ----------------------- | ----------------------------------------------------------------------- | ----------- | -------------- | ------------------- |
| Approve                 | **Approved**                                                            | Approve     | now()          | `@username`         |
| Reject                  | **Rejected**                                                            | Reject      | now()          | `@username`         |
| Add information ‚Üí —Ç–µ–∫—Å—Ç | **Needs info** *(–µ—Å–ª–∏ `NEEDS_INFO_ON_COMMENT=true`)*                    | Add info    | now()          | `@username`         |
| –û—Ç–≤–µ—Ç –±–µ–∑ –∫–Ω–æ–ø–∫–∏        | `Needs info` *(–µ—Å–ª–∏ `NEEDS_INFO_ON_COMMENT=true`), –∏–Ω–∞—á–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è* | Comment     | now()          | `@username`         |
| –û—à–∏–±–∫–∞ TG –ø–æ—Å—Ç–∏–Ω–≥–∞      | **Error**                                                               | Comment     | now()          | `@bot`              |

### 7.4 –í–µ–±—Ö—É–∫ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

* –≠–Ω–¥–ø–æ–π–Ω—Ç: `POST /api/telegram/webhook`.
* –ü—Ä–æ–≤–µ—Ä—è—Ç—å `X-Telegram-Bot-Api-Secret-Token == TELEGRAM_WEBHOOK_SECRET`.
* –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å `message` (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è `/start`, ForceReply) –∏ `callback_query`.
* –í—Å–µ DM/–ø–æ—Å—Ç—ã ‚Äî —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä–æ–º. –í `/api/telegram/send` —Ç—Ä–µ–±–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Internal-Secret: NEXTAUTH_SECRET`.

---

## 8. –û–±—Ä–∞–±–æ—Ç–∫–∞ DOCX/PDF (AI‚Äë–≤—ã–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)

### 8.1 DOCX

* –°–µ—Ä–≤–µ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: `mammoth` ‚Üí HTML ‚Üí `turndown` ‚Üí Markdown.

### 8.2 PDF

* –°–µ—Ä–≤–µ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: `pdfjs-dist` ‚Üí –∏–∑–≤–ª–µ—á—å —Ç–µ–∫—Å—Ç, –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å `textChars` –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º.
* –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞: Canvas API –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü —Å `PDF_RENDER_WIDTH`, –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Blob.
* **–ú–æ–¥–µ–ª—å–Ω—ã–π –≤—ã–±–æ—Ä**: –ø–µ—Ä–µ–¥–∞—Ç—å –º–æ–¥–µ–ª–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü `{ index, textChars, url }` –∏ –ª–∏–º–∏—Ç—ã `{ maxImages, maxInputTokens, softUsdLimit }`. –ú–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `selected[]` –∏ `reason` –¥–ª—è –∫–∞–∂–¥–æ–π.
* **Fallback‚Äë—ç–≤—Ä–∏—Å—Ç–∏–∫–∏** (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —è–≤–Ω–æ –≤–∫–ª—é—á–µ–Ω–æ): –ø–æ—Ä–æ–≥–∏ –ø–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—é —Ç–µ–∫—Å—Ç/–≥—Ä–∞—Ñ–∏–∫–∞.
* ROI detection (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): —Ç–æ–ª—å–∫–æ –ø–æ —Ñ–ª–∞–≥—É; –ø—Ä–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ ‚Äî `DIAGRAM_ROI_UNSTABLE`.

---

## 9. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –≤—ã–±–æ—Ä —á–∞–Ω–∫–æ–≤

* `POST /api/documentation` ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ø–∏—Å–æ–∫ URL.
* –ó–∞–≥—Ä—É–∂–∞—Ç—å, –æ—á–∏—â–∞—Ç—å (cheerio), –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Markdown (turndown).
* –†–∞–∑–±–∏–≤–∫–∞ –Ω–∞ —á–∞–Ω–∫–∏ –ø–æ `h1/h2` –∏–ª–∏ —Ä–∞–∑–º–µ—Ä—É 8‚Äì12k —Å–∏–º–≤–æ–ª–æ–≤.
* **–ú–æ–¥–µ–ª—å–Ω—ã–π –≤—ã–±–æ—Ä**: –ø–µ—Ä–µ–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ —á–∞–Ω–∫–æ–≤ `{ id, title, size, preview }` –∏ –ø–æ–ø—Ä–æ—Å–∏—Ç—å –≤—ã–±—Ä–∞—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ (—Å `reason`). –ó–∞—Ç–µ–º –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–¥–∞—Ç—å **–ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —á–∞–Ω–∫–æ–≤**.
* –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –≤ KV —Å TTL 24h.

---

## 10. Claude: –ø—Ä–æ–º–ø—Ç—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

### 10.1 –í—ã–∑–æ–≤ 1 ‚Äî –≤—ã–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π PDF

–í `content` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü –∏ –±—é–¥–∂–µ—Ç. –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:

```json
{
  "selected": [ { "page": 12, "reason": "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π —Å –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏" } ],
  "skip": [ { "page": 3, "reason": "–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è —Ç–µ–∫—Å—Ç –±–µ–∑ —Å—Ö–µ–º" } ]
}
```

### 10.2 –í—ã–∑–æ–≤ 2 ‚Äî –≤—ã–±–æ—Ä —á–∞–Ω–∫–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–û—Ç–≤–µ—Ç:

```json
{ 
  "selected": [ 
    { "id": "h2-auth", "reason": "—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏" } 
  ] 
}
```

### 10.3 –í—ã–∑–æ–≤ 3 ‚Äî –∏—Ç–æ–≥–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ (—Å—Ç—Ä–æ–≥–∏–π JSON)

–ü–µ—Ä–µ–¥–∞—Ç—å: —Å–æ–∫—Ä–∞—â—ë–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –∫–æ–º–ø—Ä–µ—Å—Å), **–ø–æ–ª–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —á–∞–Ω–∫–æ–≤**, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü. –í–µ—Ä–Ω—É—Ç—å **—Å—Ç—Ä–æ–≥–æ** `AnalysisResult`.

### 10.4 –í–∞–ª–∏–¥–∞—Ç–æ—Ä

* `zod`‚Äë—Å—Ö–µ–º–∞ –¥–ª—è `AnalysisResult`.
* `STRICT_ERRORS=true` ‚Äî **–±–µ–∑ –∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π** ‚Üí –ø—Ä–∏ –æ—à–∏–±–∫–µ `MODEL_INVALID_JSON`.
* `STRICT_ERRORS=false` ‚Äî –æ–¥–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ –∞–≤—Ç–æ—Ñ–∏–∫—Å–∞; –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å `autoFixed: true` –≤ PromptContextLog.

---

## 11. API –∏ SSE

### 11.1 `POST /api/documentation`

* Body: `{ urls: string[], forceRefresh?: boolean }`
* Response: `{ ok: true, rawMarkdown: string, chunks: Array<{id, title, size, preview}>, sourceUrls: string[] }`

### 11.2 `POST /api/analyze` (SSE)

* Body: `{ blobUrl, fileName, fileType, documentation, links, options, notionDatabaseId, requestMeta, diagramPages? }`
* –°–æ–±—ã—Ç–∏—è:

  * `status` ‚Äî —ç—Ç–∞–ø –∏ % –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
  * `token` ‚Äî –ø–æ—Ç–æ–∫–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã –º–æ–¥–µ–ª–∏
  * `result` ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω—ã–π `{ analysis, notionPageId, telegramMessageId }`

### 11.3 `POST /api/notion`

* –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{ notionPageId, notionUrl }`.

### 11.4 `POST /api/telegram/send`

* –û—Ç–ø—Ä–∞–≤–∫–∞ `post|reply|dm` (—Ç–æ–ª—å–∫–æ —Å —Å–µ—Ä–≤–µ—Ä–Ω—ã–º —Å–µ–∫—Ä–µ—Ç–æ–º).

### 11.5 `POST /api/telegram/webhook`

* –û–±—Ä–∞–±–æ—Ç–∫–∞ `callback_query` –∏ ForceReply. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–∫—Ä–µ—Ç–∞.

### 11.6 `GET /api/review/:id`

* –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –¥–ª—è UI.

---

## 12. KV –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

–ö–ª—é—á–∏:

* `review:{id}` ‚Üí `ReviewRequest`
* `tg:user:{username}` ‚Üí `{ userId, firstName, lastName, registered }`
* `pending-reply:{chatId}:{messageId}` ‚Üí `{ requestId, type }`
* `docs-cache:{url}:{hash}` ‚Üí `{ markdown, chunks, timestamp }`
* `analysis-cache:{blobHash}:{docsHash}` ‚Üí `{ result, timestamp }`

–ü–æ–≤—Ç–æ—Ä—ã –æ–ø–µ—Ä–∞—Ü–∏–π Notion/Telegram –∑–∞—â–∏—â–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–æ–π —É–∂–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö `pageId/messageId`.

---

## 13. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

* –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–∫—Ä–µ—Ç–∞ –≤–µ–±—Ö—É–∫–∞ Telegram.
* CORS ‚Äî —Ç–æ–ª—å–∫–æ —Å–≤–æ–π origin. CSP –≤ vercel.json.
* –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è Markdown –ø–µ—Ä–µ–¥ Telegram (—ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤).
* –í—Å–µ —Ç–æ–∫–µ–Ω—ã ‚Äî —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
* –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ–º–µ–Ω–æ–≤ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (`ALLOWED_DOC_DOMAINS`).

---

## 14. UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 14.1 –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (app/page.tsx)

* –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: —Ñ–æ—Ä–º–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: `Project name`, `Telegram username`, `Quota Link`, —Ñ–∞–π–ª).
* –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ø—Ä–æ–≥—Ä–µ—Å—Å‚Äë—à–∞–≥–∏ (SSE), —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞, —Å—Å—ã–ª–∫–∏ –Ω–∞ Notion/Telegram.

### 14.2 FileUpload.tsx

```tsx
'use client';

import { useState, useCallback } from 'react';
import { useDropzone } from 'react-dropzone';
import { Card } from '@/app/components/ui/card';
import { Button } from '@/app/components/ui/button';
import { Upload, FileText, X } from 'lucide-react';

interface FileUploadProps {
  onFileSelect: (file: File) => void;
  selectedFile: File | null;
}

export function FileUpload({ onFileSelect, selectedFile }: FileUploadProps) {
  const onDrop = useCallback((acceptedFiles: File[]) => {
    if (acceptedFiles.length > 0) {
      onFileSelect(acceptedFiles[0]);
    }
  }, [onFileSelect]);

  const { getRootProps, getInputProps, isDragActive } = useDropzone({
    onDrop,
    accept: {
      'application/vnd.openxmlformats-officedocument.wordprocessingml.document': ['.docx'],
      'application/pdf': ['.pdf']
    },
    maxFiles: 1,
    maxSize: 50 * 1024 * 1024 // 50MB
  });

  return (
    <Card className="p-6">
      <div
        {...getRootProps()}
        className={`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors
          ${isDragActive ? 'border-primary bg-primary/10' : 'border-gray-300 hover:border-primary'}`}
      >
        <input {...getInputProps()} />
        {selectedFile ? (
          <div className="flex items-center justify-center space-x-2">
            <FileText className="w-8 h-8 text-primary" />
            <span className="font-medium">{selectedFile.name}</span>
            <Button
              variant="ghost"
              size="sm"
              onClick={(e) => {
                e.stopPropagation();
                onFileSelect(null as any);
              }}
            >
              <X className="w-4 h-4" />
            </Button>
          </div>
        ) : (
          <div className="space-y-4">
            <Upload className="w-12 h-12 text-gray-400 mx-auto" />
            <div>
              <p className="text-lg font-medium">
                {isDragActive ? '–û—Ç–ø—É—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª –∑–¥–µ—Å—å' : '–ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç'}
              </p>
              <p className="text-gray-500">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ .docx –∏–ª–∏ .pdf —Ñ–∞–π–ª –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
              <p className="text-sm text-gray-400 mt-2">–ú–∞–∫—Å–∏–º—É–º 50MB</p>
            </div>
          </div>
        )}
      </div>
    </Card>
  );
}
```

### 14.3 ProcessingStatus.tsx

```tsx
'use client';

import { Card } from '@/app/components/ui/card';
import { Progress } from '@/app/components/ui/progress';
import { Loader2, AlertTriangle } from 'lucide-react';
import { ProcessingStatus as ProcessingStatusType } from '@/app/types';

interface ProcessingStatusProps {
  status: ProcessingStatusType;
}

export function ProcessingStatus({ status }: ProcessingStatusProps) {
  const isError = status.stage === 'error';

  return (
    <Card className="p-6">
      <div className="space-y-4">
        <div className="flex items-center space-x-3">
          {isError ? (
            <AlertTriangle className="w-5 h-5 text-red-500" />
          ) : (
            <Loader2 className="w-5 h-5 animate-spin text-primary" />
          )}
          <h3 className="text-lg font-semibold">
            {isError ? '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞' : '–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞'}
          </h3>
        </div>
        
        <Progress value={status.progress} className="w-full" />
        
        <div className="text-center">
          <p className={isError ? 'text-red-700' : 'text-gray-700'}>
            {status.message}
          </p>
          <p className="text-sm text-gray-500 mt-1">
            {status.progress}% –∑–∞–≤–µ—Ä—à–µ–Ω–æ
          </p>
          {isError && status.error && (
            <p className="text-xs text-red-500 mt-2">
              –ö–æ–¥ –æ—à–∏–±–∫–∏: {status.error.code}
            </p>
          )}
        </div>
      </div>
    </Card>
  );
}
```

---

## 15. –î–µ–ø–ª–æ–π (Quick Start)

### 15.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npx create-next-app@latest document-analyzer --typescript --tailwind --eslint --app --src-dir=false --import-alias "@/*"
cd document-analyzer

# –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install @anthropic-ai/sdk @notionhq/client pdfjs-dist mammoth turndown cheerio 
npm install @vercel/blob @vercel/kv zod class-variance-authority clsx tailwind-merge
npm install lucide-react @radix-ui/react-dialog @radix-ui/react-progress @radix-ui/react-toast
npm install react-dropzone sharp canvas

# Dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏  
npm install -D @types/node @types/turndown @types/cheerio

# shadcn/ui setup
npx shadcn-ui@latest init -y
npx shadcn-ui@latest add button card input progress toast dialog textarea
```

### 15.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

1. –°–æ–∑–¥–∞–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø—Ä–æ–µ–∫—Ç Vercel.
2. –ó–∞–ø–æ–ª–Ω–∏ **–≤—Å–µ env** –∏–∑ `.env.example`.
3. –í–∫–ª—é—á–∏ **Vercel Blob** –∏ **Vercel KV** –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞.
4. –î–µ–ø–ª–æ–π.

### 15.3 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å webhook
curl -X POST "https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/setWebhook" \
  -H "Content-Type: application/json" \
  -d '{
    "url":"'$NEXT_PUBLIC_APP_URL'/api/telegram/webhook",
    "secret_token":"'$TELEGRAM_WEBHOOK_SECRET'",
    "allowed_updates": ["message", "callback_query"]
  }'

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
curl "https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/getWebhookInfo"
```

### 15.4 –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

1. –ù–∞–∂–º–∏ **Start** —É –±–æ—Ç–∞ –≤ Telegram.
2. –û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤—å –ø–µ—Ä–≤—É—é –∑–∞—è–≤–∫—É.
3. –ü—Ä–æ–≤–µ—Ä—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ Notion –∏ –ø–æ—Å—Ç –≤ –∫–∞–Ω–∞–ª–µ.

---

## 16. –®–∞–±–ª–æ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª

```markdown
üîç **–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ –Ω–∞ –∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**

**–ü—Ä–æ–µ–∫—Ç:** {PROJECT_NAME}
**–ó–∞—è–≤–∏—Ç–µ–ª—å:** {REQUESTER_MENTION}

**üìã –î–µ—Ç–∞–ª–∏:**
‚Ä¢ **–ü—Ä–æ—Ü–µ—Å—Å:** {PROCESS_SHORT}
‚Ä¢ **–¢–∏–ø—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:** {DOC_TYPES_SHORT}  
‚Ä¢ **–û–±—ä—ë–º:** {VOLUME_TEXT}
‚Ä¢ **ARR:** {ARR_RUB} ‚ÇΩ
‚Ä¢ **ACV:** {ACV_RUB} ‚ÇΩ
‚Ä¢ **–†–∞–∑–º–µ—â–µ–Ω–∏–µ:** {PLACEMENT}

**üéØ –û—Ü–µ–Ω–∫–∞:**
‚Ä¢ **–†–µ–∞–ª–∏–∑—É–µ–º–æ—Å—Ç—å:** {FEASIBILITY} ({CONFIDENCE}% —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å)
‚Ä¢ **–°—Ä–æ–∫–∏:** {TIMELINE}
‚Ä¢ **–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∏—Å–∫–∏:** {TOP_MISSING}

**üîó –°—Å—ã–ª–∫–∏:**
‚Ä¢ [–ö–≤–æ—Ç–∞]({QUOTA_LINK})
‚Ä¢ [–¢–ó]({TZ_LINK})
‚Ä¢ [Pipedrive]({PIPEDRIVE_LINK})
‚Ä¢ [–ü—Ä–∏–º–µ—Ä—ã]({EXAMPLES_LINK})
‚Ä¢ [–ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª]({BLOB_URL})

üìä **–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏:** {NOTION_URL}

{MENTION_REVIEWERS}
```

---

## 17. Acceptance (–∂—ë—Å—Ç–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏)

* [ ] **–ù–µ—Ç —Å–∫—Ä—ã—Ç—ã—Ö —Ñ–æ–ª–±–µ–∫–æ–≤.** –õ—é–±–∞—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å. –ö–æ–¥ –≤–∏–¥–µ–Ω –≤ UI, –ª–æ–≥–∞—Ö, KV.
* [ ] **AI‚Äëfirst.** –í—ã–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å—Ç—Ä–∞–Ω–∏—Ü –∏ —á–∞–Ω–∫–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ ‚Äî –º–æ–¥–µ–ª—å—é; —ç–≤—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–ª—å–∫–æ –ø–æ —Ñ–ª–∞–≥—É.
* [ ] **Strict JSON.** –ü—Ä–∏ `STRICT_ERRORS=true` –±–µ–∑ –∞–≤—Ç–æ–ø–æ—á–∏–Ω–∫–∏. –û—à–∏–±–∫–∞ ‚Üí `MODEL_INVALID_JSON`.
* [ ] **Budget guard.** –û—Ü–µ–Ω–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤/—Å—Ç–æ–∏–º–æ—Å—Ç–∏; –ø—Ä–∏ —Ä–∏—Å–∫–µ ‚Äî —Å–∂–∞—Ç–∏–µ –≤—Ö–æ–¥–∞ –º–æ–¥–µ–ª—å—é. –ù–µ —É–¥–∞–ª–æ—Å—å ‚Äî `BUDGET_EXCEEDED`.
* [ ] **Notion.** –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ; –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —Å–≤–æ–π—Å—Ç–≤–∞, –±–ª–æ–∫–∏, **PromptContextLog**. –û—à–∏–±–∫–∞ ‚Üí `NOTION_ERROR`, Telegram –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è.
* [ ] **Telegram.** –ü–æ—Å—Ç —Å –∫–Ω–æ–ø–∫–∞–º–∏; `Approve/Reject/Add information` –æ–±–Ω–æ–≤–ª—è—é—Ç `Decision`, `Last Action`, `Last Action At`, `Last Moderator (TG)`; –ø—É–±–ª–∏–∫—É—é—Ç—Å—è —Ä–µ–ø–ª–∞–∏, DM –∑–∞—è–≤–∏—Ç–µ–ª—é.
* [ ] **KV.** –ó–∞—è–≤–∫–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ TG, –æ–∂–∏–¥–∞–Ω–∏—è ForceReply, –∫—ç—à–∏ ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã; –ø–æ–≤—Ç–æ—Ä—ã –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏.
* [ ] **SSE.** –ü–æ—Ç–æ–∫ `status/token/result` —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ–≥—Ä–µ—Å—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è.
* [ ] **Security.** –°–µ–∫—Ä–µ—Ç –≤–µ–±—Ö—É–∫–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è; CORS/CSP –≤–∫–ª—é—á–µ–Ω—ã; —Ç–æ–∫–µ–Ω—ã –Ω–µ —É—Ç–µ–∫–ª–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç.
* [ ] **–î–µ–ø–ª–æ–π.** Vercel –ø—Ä–æ—Ö–æ–¥–∏—Ç –±–µ–∑ —Ä—É—á–Ω—ã—Ö –ø—Ä–∞–≤–æ–∫; smoke‚Äë—Ç–µ—Å—Ç—ã —É—Å–ø–µ—à–Ω—ã.

---

## 18. Troubleshooting (–¥–æ–±–∞–≤–∏—Ç—å –≤ README)

* **MODEL\_INVALID\_JSON** ‚Äî –º–æ–¥–µ–ª—å –≤–µ—Ä–Ω—É–ª–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON. –ü—Ä–∏ `STRICT_ERRORS=true` ‚Äî –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å ¬´–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∞–Ω–∞–ª–∏–∑¬ª; –ø—Ä–∏ `false` ‚Äî –æ–¥–Ω–∞ –∞–≤—Ç–æ‚Äë–ø–æ–ø—ã—Ç–∫–∞ —Ñ–∏–∫—Å —Å –ø–æ–º–µ—Ç–∫–æ–π `autoFixed`.
* **RATE\_LIMIT / 429** ‚Äî –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è —Ä–µ—Ç—Ä–∞–∏ —Å backoff. –ü—Ä–∏ –Ω–µ—É–¥–∞—á–µ –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
* **NOTION\_ERROR** ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω, –ø—Ä–∞–≤–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, –∏–º–µ–Ω–∞ —Å–≤–æ–π—Å—Ç–≤ (–∏–ª–∏ –∑–∞–¥–∞—Ç—å `NOTION_PROPERTY_MAP`).
* **TELEGRAM\_POST\_ERROR** ‚Äî –ø—Ä–æ–≤–µ—Ä—å `TELEGRAM_CHANNEL_ID`, –ø—Ä–∞–≤–∞ –±–æ—Ç–∞ (admin), —Å–µ–∫—Ä–µ—Ç –≤–µ–±—Ö—É–∫–∞.
* **USERNAME\_NOT\_REGISTERED** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–∂–∞–ª Start —É –±–æ—Ç–∞.
* **AI\_DISABLE\_UPLOADS=true** ‚Äî –∞–Ω–∞–ª–∏–∑ –æ—Ç–∫–ª—é—á—ë–Ω –ø–æ–ª–∏—Ç–∏–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

---

## 19. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è Cursor (–ö–†–ò–¢–ò–ß–ù–û)

### 19.1 –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
   ```bash
   npx create-next-app@latest document-analyzer --typescript --tailwind --eslint --app --src-dir=false --import-alias "@/*"
   cd document-analyzer
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** (—Ç–æ—á–Ω–æ –ø–æ —Å–ø–∏—Å–∫—É –∏–∑ 15.1)

3. **–°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤:**
   - –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π **–í–°–ï** —Ñ–∞–π–ª—ã –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (—Ä–∞–∑–¥–µ–ª 2)
   - –î–æ–±–∞–≤—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (5.1-5.4)
   - –°–æ–∑–¥–∞–π —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (—Ä–∞–∑–¥–µ–ª 4)
   - –†–µ–∞–ª–∏–∑—É–π –≤—Å–µ API endpoints (—Ä–∞–∑–¥–µ–ª 11)
   - –°–æ–∑–¥–∞–π UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (—Ä–∞–∑–¥–µ–ª 14)

### 19.2 –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**app/lib/config.ts** ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
```ts
export const config = {
  anthropic: {
    apiKey: process.env.ANTHROPIC_API_KEY!,
    model: process.env.ANTHROPIC_MODEL || 'claude-3-5-sonnet-20241022',
    maxInputTokens: parseInt(process.env.AI_MAX_INPUT_TOKENS || '180000'),
    maxImages: parseInt(process.env.AI_MAX_IMAGES || '10'),
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  },
  notion: {
    token: process.env.NOTION_TOKEN!,
    databaseId: process.env.NOTION_DATABASE_ID!,
    propertyMap: JSON.parse(process.env.NOTION_PROPERTY_MAP || '{}'),
  },
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã
};
```

**–°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è** ‚Äî –≤—Å–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ç–æ—á–Ω–æ –∫–∞–∫ –≤ —Ä–∞–∑–¥–µ–ª–µ 4.

**Error handling** ‚Äî –∫–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ª–∏–±–æ —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ª–∏–±–æ –æ–±—ä–µ–∫—Ç —Å `ErrorCode`.

**SSE implementation** ‚Äî `/api/analyze` –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏—è `status`, `token`, `result`.

### 19.3 –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** ‚Äî —Ñ–∞–π–ª—ã, —Ç–∏–ø—ã, –∫–æ–Ω—Ñ–∏–≥
2. **–£—Ç–∏–ª–∏—Ç—ã** ‚Äî blob, cache, security, utils  
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** ‚Äî docx.ts, pdf.ts
4. **AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** ‚Äî claude.ts —Å —Ç—Ä–µ–º—è —Ç–∏–ø–∞–º–∏ –≤—ã–∑–æ–≤–æ–≤
5. **–í–Ω–µ—à–Ω–∏–µ API** ‚Äî notion.ts, telegram.ts
6. **API endpoints** ‚Äî –≤—Å–µ routes
7. **UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** ‚Äî –ø–æ –ø–æ—Ä—è–¥–∫—É —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
8. **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 19.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

* `npm run build` –ø—Ä–æ—Ö–æ–¥–∏—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
* –í—Å–µ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ .env.example –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
* TypeScript strict mode –≤–∫–ª—é—á–µ–Ω
* –ù–µ—Ç –∫–æ–Ω—Å–æ–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
* –í—Å–µ import/export –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

---

## 20. –ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

* `PROJECT_NAME`: `euroins.kz - —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã`
* `PROCESS_SHORT`: `–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–∞–≤–∞ –ø–∞–∫–µ—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ —Å—Ç—Ä–∞—Ö–æ–≤–æ–º —Å–ª—É—á–∞–µ –ø–æ —Ç–∏–ø—É —Å–ª—É—á–∞—è, –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–ª–µ–π –∏–∑ –∫–∞–∂–¥–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞`
* `DOC_TYPES_SHORT`: `–¥–æ–≥–æ–≤–æ—Ä, —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏, —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–∞, –º–µ–¥. —Ñ–æ—Ä–º—ã, —Å–ø—Ä–∞–≤–∫–∏`
* `VOLUME_TEXT`: `93 000 ‚Äì 120 000 —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –º–µ—Å—è—Ü`
* `ARR_RUB`: `3000000`
* `ACV_RUB`: `12000000`
* `PLACEMENT`: `Cloud`

---

**–ì–û–¢–û–í–û.** –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è. –°–∫–æ–ø–∏—Ä—É–π –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤ Cursor, —Å–ª–µ–¥—É–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º —Ä–∞–∑–¥–µ–ª–∞ 19, –∏ –ø–æ–ª—É—á–∏—à—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.